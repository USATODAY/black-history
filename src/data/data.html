<!doctype html>
<html>
<head>
    
<!--
App name: JSON-a-matic 10000
Version: 3.2
Author: Chad Palmer
-->


    <meta charset="UTF-8">
    <meta name="description" content="The JSON-a-matic 10000 can convert Excel and Google Doc spreadsheets into JSON data as well as automatically formatting dates and latitude/longitude for geographic locations.">
    <meta name="keywords" content="Data converter, Excel, Google Doc, spreadsheets, Excel to JSON Converter, Google Doc spreadsheet to JSON converter, data, geocode, JSON, JSON data">
    <meta property="fb:app_id" content="215046668549694"/>
    <meta property="og:description" content="Convert Excel and Google Doc spreadsheets to JSON data"/>
    <meta property="og:image" content="http://json-a-matic.herokuapp.com/static/json_a_matic/images/fb-post.jpg">
    <meta property="og:url" content="http://json-a-matic.herokuapp.com/"/>
    <meta property="og:type" content="website">
    <meta property="og:title" content="CP's JSON-a-matic 10000"/>
    <title>CP's JSON-a-matic 10000</title>
    <link rel="stylesheet" type="text/css" href="/static/json_a_matic/css/json-generator.css" />
    <link rel="shortcut icon" href="http://www.gannett-cdn.com/sites/usatoday/images/favicon.png" />

    <script type="text/javascript">
        var processLayer, dotsSpan, directionLayer, dotTimeId, outputOption, outputOptionPanel, userForm, fileTimerId;

        function init(blnAuto) {
            processLayer = document.getElementById("overlay");
            dotsSpan = document.getElementById("dots");
            directionLayer = document.getElementById("direction-box");
            outputOption = document.getElementById("output_format_browser");
            outputOptionPanel = document.getElementById("output_option_panel");
            if (blnAuto) {
                displayProcessing();
            }
        }

        function displayProcessing() {
            processLayer.style.display = "block";
            dotTimeId = setInterval(animateDots, 300);
            if (!outputOption.checked) {
                fileTimerId = window.setInterval(function () {
                    var cookieValue = getCookie("filedownloaddone");
                    if (cookieValue == "true") {
                        hideProcessing();
                    }
                }, 1000);

            }
            hideDirections();
        }

        function hideProcessing() {
            setTimeout('processLayer.style.display = "none";', 5000);
            clearInterval(dotTimeId);
            clearInterval(fileTimerId);
            deleteCookie("filedownloaddone");
        }

        function animateDots() {
            var dots = dotsSpan.innerHTML;
            if (dots.length > 10) {
                dotsSpan.innerHTML = "";
            } else {
                dotsSpan.innerHTML = dotsSpan.innerHTML + ".";
            }
        }

        function showDirections() {
            directionLayer.style.display = "block";
        }

        function hideDirections() {
            directionLayer.style.display = "none";
        }

        function updateOptions() {
            if (outputOption.checked) {
                outputOptionPanel.style.display = "none";
            } else {
                outputOptionPanel.style.display = "block";
            }
        }

        function getCookie(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for(var i=0; i<ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1);
                if (c.indexOf(name) != -1) return c.substring(name.length, c.length);
            }
            return "";
        }

        function deleteCookie(cname) {
            document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        }

        window.onbeforeunload = function (e) {
            hideProcessing();
        }

    </script>

    <script type="text/javascript">
        setTimeout("toggleLocations();", 10000);
        function toggleLocations() {
            history.replaceState({"view": "index"}, "CP's JSON-a-matic 10000", "/");
            document.location='/display/7/';
        }
    </script>
</head>
<body onload="init(true);">
<div id="overlay">Your Excel file is being processed. Large files may take several minutes. Please wait <span id="dots"></span></div>

<div id="direction-box" class="direction-box">
    <a href="javascript: hideDirections();" class="direction-close"></a>
    <p class="section-head">1. Preparing the Excel/Google Doc spreadsheet file</p>
    <p class="section-text">a. If you want to create a simple flat Excel/JSON file, you simply put the key values in the first row (column names) of a single Excel sheet and then fill in the data as needed in the following rows. You can skip the optional features in the rest of this section and go to section 2. Using the JSON-a-matic 10000</p>
    <p class="section-text">NOTE: YOu must first publish your Google Doc spreadsheet before using the JSON-a-matic to render JSON from it. The published URL will end with "/pubhtml". Please see <a href="https://support.google.com/docs/answer/37579?hl=en" target="_blank">publishing instructions for Google Docs</a> if you do not know how to publish your Google spreadsheet.</p>
    <p class="section-subhead">Optional features for preparing the ExcelGoogle Doc spreadsheet file</p>
    <p class="section-bold">Break up JSON files by specified category (available with download only)</p>
    <p class="section-text">1: For cases where you want multiple smaller JSON files rather than one large file, you select the "Automatically download file(s)" option in box 2 (Select desired output format).</p>
    <p class="section-text">2: You then enter the column name you want the JSON files to be split up on. (It is case-insensitive.)</p>
    <p class="section-text">3: I highly recommend that you sort the Excel data by the column name you specified in step 2. Otherwise, you will have multiple files for each value in that column. (Unless of course that's what you want in order to break up large categories.)</p>
    <p class="section-text">4: The downloaded output for this option will be a "data.zip" file that contains all the smaller JSON files. On extraction, the JSON files will be expanded into a "data_json" sub-folder relative to where the "data.zip" file is located.</p>
    <p class="section-bold">Automatic date Converter</p>
    <p class="section-text">1: Excel renders dates as 5-digit numbers so if you want the dates displayed in the standard mm/dd/yyyy automatically, you need to name the columns with dates with an "_date" appended to the name. For example, a column named "event_date" will render the date correctly in the JSON file. This applies to both flat and nested JSON files." </p>
    <p class="section-bold">Automatic lat/long generation from geographic location/address</p>
    <p class="section-text">1: Adding "_geocode" to the column names with geographic locations/addresses will trigger the automatic lookup and generation of latitude and longitude entries for the locations in the "_geocoder" column</p>
    <p class="section-bold">Creating nested JSON file</p>
    <p class="section-text">1: If you want to create a nested Excel/JSON file with one or more levels of nesting, you put the key values in the first rows (column names) of all the Excel sheets and then fill in the data as needed in the following rows just like you do with the flat/single Excel sheet.</p>
    <p class="section-text">2: You will need to name each of the Excel sheets so you can reference them later. Please keep the following in mind when naming the sheets: You can not use dashes in the first row (column) names or in the sheet names as I split the nested parameters up using the dash. Please use underscores instead.</p>
    <p class="section-text">3: To set up a nested column, you format the nested tag as **nested-{column name}-{sheet name}. For ex: **nested-id-hobby would look for matches in the id columns of the current Excel sheet being parsed and a different sheet named hobby. The **nested- tells the JSON-a-matic that you want to nest JSON in that column.</p>
    <p class="section-text">4: You can nest as many levels as you want up to infinity in theory. I wouldn't actually try to approach infinite nests as that would cause the universe to collapse into a quantum singularity which would cause significant server lag time as the universe was recreated. Below is an image of a sample nesting Excel workbook.</p>
    <table width="640" border="0" cellspacing="0" cellpadding="0" class="direction-table">
        <tr>
            <td><p class="section-text">Primary (main) Excel sheet</p>
            <img src="/static/json_a_matic/images/main.jpg" width="462" height="140" alt=""/></td>
        </tr>
        <tr>
            <td><p class="section-text">Secondary (hobby) Excel sheet that gets nested</p>
            <img src="/static/json_a_matic/images/hobby.jpg" width="640" height="206" alt=""/></td>
        </tr>
    </table>
    <p class="section-text last">Please notice the ID (not case-sensitive by the way) that is common to both the primary (main) and secondary (hobby) tables and that is specified in the nested tag parameter all circled in red. Also notice the green sheet name (hobby) specified in the nested tag parameter and the corresponding Excel sheet named hobby all circled in green. You can download a sample Excel file that is formatted for 4 levels of nesting as well as incorporating all of the optional features by clicking/saving the following link: <a href="/static/json_a_matic/files/excel-test.xlsx">Sample nested Excel file for JSON-a-matic 10000</a></p>
    <p class="section-head">2. Using the JSON-a-matic 10000</p>
    <p class="section-text">a. Once you are done editing the Excel, file you can publish it to a URL so other people can run the JSON-a-matic 10000 on it or you can save it to your computer and then select the file in the JSON-a-matic directly</p>
    <p class="section-text">b. Click the "Give me my JSON baby!" button to create the JSON. Please note that it might take a while to process very large files.</p>
    <p class="section-text">c. Once you see your JSON appear in the browser, you can right-click and save the file wherever you want. Please note that large files will overwhelm your browser's JSON pretty-atizer so it will look like a jumbled mess, but it will still be valid JSON. You can now do back flips as you celebrate having your new JSON file. Please note the location of nearby furniture before doing back flips to help prevent dain bramage.</p>
    <p class="section-subhead">Optional features for using the JSON-a-matic 10000</p>
    <p class="section-bold">Using API feature for chron jobs/automated scraping</p>
    <p class="section-text">1: Once you have published your Google Doc spreadsheet or your Excel file, you can call the JSON-a-matic as you would an API app by formatting the URL as follows.<br/>
    <span class="section-indent yellow">http://json-a-matic.herokuapp.com/api/?url={your_url}</span><br/>
    <span class="section-indent"><b>For example:</b> <span class="yellow">http://json-a-matic.herokuapp.com/api/?url=https://docs.google.com/spreadsheets/d/1VeHKGHsAZWqvgPaktZHq0sWXWvaVZYU-V704oHzp4g0/pubhtml</span></span><br/>
    <span class="section-indent">will process my test Google Doc and return JSON to the AJAX(or any other http request) caller.</span></p>
    <p class="section-text">2: VERY IMPORTANT: Please only use this for chron jobs/scrapers that convert the Google/Excel spreadsheet data to JSON and then FTPs the JSON file to your server to be used by your app. Linking directly to the JSON-a-matic API page in your app would hammer the JSON-a-matic with tons of traffic and likely kill my Heroku dinos. Also, your app performance would be awful since it would have to regenerate the JSON every time it loads rather than getting an already-created JSON file off of your server. The intent of this API feature is to allow automatic updates to your app's JSON file so that a developer does not have to do it by hand, but can instead write a chron job script on his/her server that checks for new updates at the specified time interval.</p>
</div>


<div class="header"><img src="/static/json_a_matic/images/logo.jpg" width="83" height="65"><h1>JSON-a-matic 10000</h1><span class="page-gray">version 3.3</span><a class="help-link" href="javascript: showDirections();">Help/Directions</a></div>




<form id="user_form" enctype="multipart/form-data" action="/generate/" method="post">
    <input type='hidden' name='csrfmiddlewaretoken' value='Y0rIuP5Qbt09JOg0qWxFsgTtXUfA2J6Z' />
    <div class="section-box">
        <div class="section-box-label">
            <div class="number-box">1</div>
            <span class="section-box-head">Select an Excel file to process</span>
        </div>
        <div class="section-fields">
            <label class="field-label" for="excel_url">Enter path/URL to Excel file</label>
            <input type="text" name="excel_url" id="excel_url" placeholder="URL to Excel file" class="url-field"/>

            <p class="subhead">OR</p>
            <input type="file" name="excel_file" id="excel_file" class="file-upload" placeholder=" or drag and drop Excel file here"/>
            <label class="field-label file" for="excel_file">Click blue box to browse for an Excel file or drag and drop an Excel file from your computer into the blue box</label>
        </div>
    </div>

    <div class="section-box">
        <div class="section-box-label">
            <div class="number-box">2</div>
            <span class="section-box-head">Select desired output format</span>
        </div>
        <div class="section-fields">
            <div>
                <input type="radio" name="output_format" id="output_format_browser" class="radio-button" checked onclick="updateOptions();" value="browser"/>
                <label class="field-label radio" for="output_format_browser">Display in browser</label></div>
            <div>
                <input type="radio" name="output_format" id="output_format_download" class="radio-button" onclick="updateOptions();" value="download"/>
                <label class="field-label radio" for="output_format_download">Automatically download file(s)</label>
            </div>
            <div id="output_option_panel" class="optional">
                <label class="field-label" for="category_slice">OPTIONAL: Enter Excel column name to break up JSON files by that category. (Batch of JSON files will be downloaded as a zip archive.) Leave blank to download single JSON file</label>
                <input type="text" name="category_slice" id="category_slice" placeholder="Optional Excel column name" class="url-field"/>
            </div>
        </div>
    </div>

    <div class="section-box">
        <div class="section-box-label">
            <div class="number-box">3</div>
            <span class="section-box-head">Generate your JSON</span>
        </div>
        <div class="section-fields">
            <input type="submit" value="Give me my JSON baby!" class="generate" onclick="displayProcessing();"/>
        </div>
    </div>
    <div class="section-text black">Please email <a href="mailto:cpalmer@usatoday.com">Chad Palmer</a> with bug reports
        and suggestions.
    </div>
    
<div class="features">
    <div class="field-label">New features/fixes in version 3.3</div>
    <ul class="feature-list">
        <li class="section-text black">Fixed issue where Python list was not being converted to JSON output in the multiple file download option.</li>
    </ul>
    <div class="field-label">New features/fixes in version 3.2</div>
    <ul class="feature-list">
        <li class="section-text black">Added the Mapbox geo-coder API as the primary geocode lookup since we are paying for it already, but kept the Google geo-coder as a backup for the rare times Mapbox fails.</li>
    </ul>
    <div class="field-label">New features/fixes in version 3.1</div>
    <ul class="feature-list">
        <li class="section-text black">Fixed bug in file download split by column option where the last JSON was not added to the zip file.</li>
        <li class="section-text black">Moved timer countdown/checker to front-end to free up Heroku dyno immediately.</li>
        <li class="section-text black">Adjusted back end process to fix issue with timeout errors when processing very large Excel files.</li>
        <li class="section-text black">Fixed issue that caused processing of Google spreadsheets to fail.</li>
    </ul>
    <div class="field-label">New features/fixes in version 3.0</div>
    <ul class="feature-list">
        <li class="section-text black">Added drag and drop capability</li>
        <li class="section-text black">Added output format options/file download options</li>
        <li class="section-text black">Within the file download options, added the ability to break up large Excel files into smaller JSON files by a specified column.</li>
    </ul>
    <div class="field-label">New features/fixes in version 2.0</div>
    <ul class="feature-list">
        <li class="section-text black">Fixed issue where certain entries for excel date conversion (_date columns) caused app to crash</li>
        <li class="section-text black">Added support for PUBLISHED Google Doc spreadsheets</li>
        <li class="section-text black">Added optional automatic lat/long generation for geographic locations (_geocode columns)</li>
        <li class="section-text black">Added optional API-like behavior that can be used by automated chron jobs or scrapers to update JSON files.</li>
        <li class="section-text black">Updated Help/Directions page instructions/documentation as well as sample excel file.</li>
    </ul>
</div>

</form>
</body>
</html>